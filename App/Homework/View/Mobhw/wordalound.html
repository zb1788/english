<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>英语同步练</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="wap-font-scale" content="no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="__PUBLIC__/css/mui.min.css">
		<link rel="stylesheet" href="__PUBLIC__/css/font-awesome.min.css">
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			.mui-views,
			.mui-view,
			.mui-pages,
			.mui-page,
			.mui-page-content {
				position: absolute;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
				width: 100%;
				height: 100%;
				background-color: #efeff4;
			}
			.mui-pages {
				top: 32px;
				height: auto;
			}
			.mui-scroll-wrapper,
			.mui-scroll {
				background-color: #efeff4;
			}
			.mui-page.mui-transitioning {
				-webkit-transition: -webkit-transform 300ms ease;
				transition: transform 300ms ease;
			}
			.mui-page-left {
				-webkit-transform: translate3d(0, 0, 0);
				transform: translate3d(0, 0, 0);
			}
			.mui-ios .mui-page-left {
				-webkit-transform: translate3d(-20%, 0, 0);
				transform: translate3d(-20%, 0, 0);
			}
			.mui-navbar {
				position: fixed;
				right: 0;
				left: 0;
				z-index: 10;
				height: 44px;
				background-color: #f7f7f8;
			}
			.mui-navbar .mui-bar {
				position: absolute;
				background: transparent;
				text-align: center;
			}
			.mui-android .mui-navbar-inner.mui-navbar-left {
				opacity: 0;
			}
			.mui-ios .mui-navbar-left .mui-left,
			.mui-ios .mui-navbar-left .mui-center,
			.mui-ios .mui-navbar-left .mui-right {
				opacity: 0;
			}
			.mui-navbar .mui-btn-nav {
				-webkit-transition: none;
				transition: none;
				-webkit-transition-duration: .0s;
				transition-duration: .0s;
			}
			.mui-navbar .mui-bar .mui-title {
				display: inline-block;
				width: auto;
			}
			.mui-page-shadow {
				position: absolute;
				right: 100%;
				top: 0;
				width: 16px;
				height: 100%;
				z-index: -1;
				content: '';
			}
			.mui-page-shadow {
				background: -webkit-linear-gradient(left, rgba(0, 0, 0, 0) 0, rgba(0, 0, 0, 0) 10%, rgba(0, 0, 0, .01) 50%, rgba(0, 0, 0, .2) 100%);
				background: linear-gradient(to right, rgba(0, 0, 0, 0) 0, rgba(0, 0, 0, 0) 10%, rgba(0, 0, 0, .01) 50%, rgba(0, 0, 0, .2) 100%);
			}
			.mui-navbar-inner.mui-transitioning,
			.mui-navbar-inner .mui-transitioning {
				-webkit-transition: opacity 300ms ease, -webkit-transform 300ms ease;
				transition: opacity 300ms ease, transform 300ms ease;
			}
			.mui-page {
				display: none;
			}
			.mui-pages .mui-page {
				display: block;
			}
			.mui-page .mui-table-view:first-child {
				margin-top: 15px;
			}
			.mui-table-view {
				margin-top: 20px;
			}
			
			.mui-table-view span.mui-pull-right {
				color: #999;
			}
			.mui-table-view-divider {
				background-color: #efeff4;
				font-size: 14px;
			}
			.mui-table-view-divider:before,
			.mui-table-view-divider:after {
				height: 0;
			}
			.mui-fullscreen {
				position: fixed;
				z-index: 20;
				background-color: #000;
			}
			.mui-ios .mui-navbar .mui-bar .mui-title {
				position: static;
			}
			#accountcontent a {
				margin: 5px;
				width: 40px;
				height: 40px;
				display: inline-block;
				text-align: center;
				background-color: #fff;
				border: 1px solid #ddd;
				border-radius: 25px;
				background-clip: padding-box;
			}
			.mui-content-padded a .mui-icon {
				margin-top: 12px;
			}
			.mui-spinner,
			.mui-spinner-white {
				margin-top: 12px
			}
			.active .mui-spinner-indicator {
				background: #007AFF;
			}
			
			#accountcontent a {
				color: #8F8F94;
			}
			#accountcontent a.active {
				color: #007aff;
			}
			#accountcontent a .mui-icon {
			   margin-top: 12px;
			}
			#accountcontent a .mui-icon {
				font-family: Muiicons;
				font-size: 20px;
				font-weight: 400;
				font-style: normal;
				line-height: 1;
				display: inline-block;
				text-decoration: none;
				-webkit-font-smoothing: antialiased;
			}
			.mui-icon-close:before {
				border-radius: 25px;
				background-color: red;
			}
			/*设置标题样式字体*/
			div.title *{
			    font-size:1.2em;
			    font-family: times;
			    color: blueviolet;
			}			
			/*新的播放样式*/
			.play-pause {
			  width: 44px;
			  height:43px;
			  /*display: inline-block;
			  position: absolute;
			  left: 100px;
			  top: 7px;*/
			  margin:0 auto;
			  background-image: url("__PUBLIC__/images/play-dark.gif");
			  background-size:cover;
			  border-radius: 100px;
			  background-repeat: no-repeat;
			  cursor: pointer;
			}
			.play-pause.paused {
			  background-image: url("__PUBLIC__/images/pause-dark.gif");
			}
			.play-pause.pausing {
			  background-image: url("__PUBLIC__/images/play-to-pause-dark.gif");
			}
			.play-pause.playing {
			  background-image: url("__PUBLIC__/images/pause-to-play-dark.gif");
			}
			#loading{
				margin:0 auto;
                color:#000;
                border-width:4px;
                width: 44px;
                height: 44px;
                border-style: solid;
                border-color: #ccc #eee red blue;
                border-radius: 24px;
                -webkit-animation: loading  1s infinite linear;
            }
	        @-webkit-keyframes loading{
	                from{
	                	-webkit-transform:rotate(0deg);
	                }
	                to{
	                	-webkit-transform:rotate(360deg);
	                }
	        }
	        
	        /*小红点样式*/
	       .redpoint{
	       	  height:10px;
			  width:10px;
			  border-radius:16px;
			  font-size:0.1em;
			  color:#fff;
			  background:red;
	       }
					
		</style>
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/feedback.css" />
	</head>
	<body class="mui-fullscreen">
		<!--页面主结构开始-->
		<div id="app" class="mui-views">
			<div class="mui-view">
				<div class="mui-navbar">
				</div>
				<div class="mui-pages">
				</div>
			</div>
		</div>
		<!--页面主结构结束-->
		<!--单页面开始-->
		<div id="setting" class="mui-page">
			<!--页面标题栏开始-->
			<div class="mui-navbar-inner mui-bar mui-bar-nav">
				<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
					<span class="mui-icon mui-icon-left-nav"></span>
				</button>
				<a class="mui-pull-right mui-right" href="#topPopover"  id="enhomework" style="position: fixed;top: 10px;right:6px;">
				 	 作业
				 	<if condition="$wordalound eq '0' or $wordtest eq '0' or $textalound eq '0' or $examsquiz eq '0'">
						<span class="redpoint mui-icon" style="width:10px;height:10px;"> 
						</span>
					</if>
				</a>
				<h1 class="mui-icon" id="timeshow" style="position:fixed;left:100px;top:-5px;">
					<font id="time" style="font-size:0.7em;">00:00</font>
				</h1>
				<a class="mui-icon" id="datika" style="position:fixed;right:100px;top:0px;" id="summary" href="#account" >
					<i class="fa fa-calculator fa-1" style="font-size:20px;color: dimgray;"></i>
				</a>
				
			</div>
			<!--页面标题栏结束-->
			<!--页面主内容区开始-->
			<div class="mui-page-content">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<div>
							<ul class="mui-table-view mui-table-view-striped mui-table-view-condensed">
								<li class="mui-table-view-cell">
									<h4>
										2015年河南省中招考试
										<span class="mui-pull-right" id="quesnum">
											<strong style="color:red;font-size:1.5em;" id="quesindex">{$index+1}</strong>/{$quescount}
										</span>
									</h4>
									
								</li>
							</ul>
						</div>
						<div class="content" id="content">
						<!--内容填充页面-->
						</div>
					</div>
				</div>
			</div>
			<!--页面主内容区结束-->
		</div>
		<!--单页面结束-->
		<div id="account" class="mui-page">
			<div class="mui-navbar-inner mui-bar mui-bar-nav">
				<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
					<span class="mui-action-back mui-icon mui-icon-close mui-pull-left" style="padding-top:8px;"></span>
				</button>
				<h1 class="mui-center mui-title">答题器</h1>
				<a class="mui-pull-right" href="#topPopover"  id="enhomework" style="position: fixed;top: 10px;right: 6px;">
				 	 作业
					<if condition="$wordalound eq '0' or $wordtest eq '0' or $textalound eq '0' or $examsquiz eq '0'">
						<span class="redpoint mui-icon"> 
						</span>
					</if>
				</a>
				<!--<a class="mui-icon   mui-pull-right" id="summary" href="#account"></a>-->
			</div>
			<div class="mui-page-content">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll" id="accountcontent" style="margin-top:20px;">
	                <!--答题器统计页面-->	
					</div>
				</div>
			</div>
		</div>
		<div id="jplayer"></div>
		<div id="topPopover" class="mui-popover" style="width:120px;min-height:120px;">
			<div>
				<ul class="mui-table-view">
					<if condition="$wordalound neq '-1'">
						<li class="mui-table-view-cell enhome" location="question">
							<a href="javascript:void(0);">
								单词跟读
								<if condition="$wordalound eq '0'">
									<span class="redpoint mui-icon"> 
									</span>
								</if>
							</a>
						</li>
					</if>
					<if condition="$wordtest neq '-1'">
						<li class="mui-table-view-cell enhome" location="test">
							<a href="javascript:void(0);">
								单词测试
								<if condition="$wordtest eq '0'">
									<span class="redpoint mui-icon"> 
									</span>
								</if>
							</a>
						</li>
					</if>
					<if condition="$textalound neq '-1'">
						<li class="mui-table-view-cell enhome" location="http://www.baidu.com">
							<a href="javascript:void(0);">
								课文跟读
								<if condition="$textalound eq '0'">
									<span class="redpoint mui-icon"> 
									</span>
								</if>
							</a>
						</li>
					</if>
					<if condition="$examsquiz neq '-1'">
						<li class="mui-table-view-cell enhome" location="http://www.baidu.com">
							<a href="javascript:void(0);">
								课文跟读
								<if condition="$examsquiz eq '0'">
									<span class="redpoint mui-icon"> 
									</span>
								</if>
							</a>
						</li>
					</if>
				</ul>
			</div>
		</div>
	</body>
	<script>
		var fheight=0;
		var pheight=0;
		var cheight=0;
		var exams_mp3_url="http://192.168.151.206/yylmp3/mp3_exam/";
		//定义音频避免同一页面频繁的数据请求
	    var listendata=[];
	</script>
	<script type="text/javascript" src="__PUBLIC__/js/jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="__PUBLIC__/js/jquery.jplayer.min.js"></script>
	<script type="text/javascript" src="__PUBLIC__/js/mp3.js"></script>
	<script src="__PUBLIC__/js/mui.min.js" type="text/javascript"></script>
	<script src="__PUBLIC__/js/mui.view.js" type="text/javascript"></script>
	<script type="text/javascript" src="__PUBLIC__/js/websql.js"></script>
	<script type="text/javascript" src="__PUBLIC__/js/learn.js"></script>
	<script>
		mui.init();
		var quescount=parseInt("{$quescount}");
		var studentid="123456";
		var classid="123456";
		var homeworkid="66";
		var summaryhtml="";
		var index="{$index}";
		var type="{$type}";
		//进行时间的读秒
		var c=parseInt("{$time}"); 
		timedCount();
		function timedCount(){
			var min=0,secs=0;
			var value="";
		    min = parseInt(c / 60);// 分钟数  
		    if(min<10){
		    	value=value+"0"+min;
		    }else{
		    	value=value+min;
		    }
		    secs = c % 60;
		    if(secs<10){
		    	value=value+":0"+secs;
		    }else{
		    	value=value+":"+secs;
		    }
		    document.getElementById('time').innerHTML =value;
		    c=c+1  ;
		}
		setInterval("timedCount()",1000);
		//页面初始化进行加载
		getRespose('getQuestion',"网络请求出错请等会儿再试试",parseInt(index),0,0);
		websqlOpenDB();
		websqlCreatTable("questions");
		websqlDeleteAllDataFromTable("questions");
		getSummaryData(homeworkid);
		//初始化单页view
		var viewApi = mui('#app').view({
			defaultPage: '#setting'
		});
		//初始化单页的区域滚动
		mui('.mui-scroll-wrapper').scroll();
		var view = viewApi.view;
		(function($) {
			//处理view的后退与webview后退
			var oldBack = $.back;
			$.back = function() {
				if (viewApi.canBack()) { //如果view可以后退，则执行view的后退
					viewApi.back();
				} else { //执行webview后退
					oldBack();
				}
			};
			
			
			//监听页面切换事件方案1,通过view元素监听所有页面切换事件，目前提供pageBeforeShow|pageShow|pageBeforeBack|pageBack四种事件(before事件为动画开始前触发)
			//第一个参数为事件名称，第二个参数为事件回调，其中e.detail.page为当前页面的html对象
			view.addEventListener('pageBeforeShow', function(e) {
				//console.log(e.detail.page.id + ' beforeShow');
				
				if(e.detail.page.id=="account"){
					document.getElementById("timeshow").style.display="none";
					document.getElementById("datika").style.display="none";
					summaryhtml="";
					//查询本地数据库中的数据
					websqlGetAllData("questions",homeworkid,studentid,classid,setSummary);
				}else{
					document.getElementById("timeshow").style.display="";
					document.getElementById("datika").style.display="";
				}
			});
			view.addEventListener('pageShow', function(e) {
				console.log(e.detail.page.id + ' show');
			});
			view.addEventListener('pageBeforeBack', function(e) {
				console.log(e.detail.page.id + ' beforeBack');
			});
			view.addEventListener('pageBack', function(e) {
				console.log(e.detail.page.id + ' back');
			});
			
			//汇总的数据
			function setSummary(data){
				var i=0;
				var j=0;
				for(i=1;i<=quescount;i++){
					if(data[j]==i){
						j=j+1;
		        		summaryhtml=summaryhtml+'<a id="icon-icon-contact" class="quessummary" style="background-color:blue;"><span class="mui-icon">'+i+'</span></a>';
		        	}else{
		        		summaryhtml=summaryhtml+'<a id="icon-icon-contact" class="quessummary"><span class="mui-icon">'+i+'</span></a>';
		        	}	
				}
				console.log(summaryhtml);
				document.getElementById("accountcontent").innerHTML=summaryhtml;
			}
			
			//试题汇总
			mui("div#accountcontent").on("tap","a.quessummary",function(){
				var index=this.getElementsByTagName("span")[0].innerHTML;
				var url="index?index="+(parseInt(index)-1)+"&time="+c;
				mui.openWindow(url);  
			});
			
			//作业跳转
			mui("div#topPopover").on('tap',"li.enhome",function(){
				//进行跳转
				var href=this.getAttribute("location");
				mui.openWindow(href);
			});
			
			//小红点弹出问题
			mui('body').on('shown', '.mui-popover', function(e) {
				console.log('shown', e.detail.id);//detail为当前popover元素
			});
			mui('body').on('hidden', '.mui-popover', function(e) {
				console.log('hidden', e.detail.id);//detail为当前popover元素
			});
		})(mui);
	</script>
</html>