window.getWinSize=function(){return[$(window).width(),$(window).height()];if(window.innerWidth!=undefined){return[window.innerWidth,window.innerHeight]}else{var B=document.body,D=document.documentElement;return[Math.max(D.clientWidth,B.clientWidth),Math.max(D.clientHeight,B.clientHeight)]}};window.getScrollPos=function(){return[$(document).scrollLeft(),$(document).scrollTop()];scrollX=0;scrollY=0;if(document.documentElement&&document.documentElement.scrollTop){scrollX=document.documentElement.scrollLeft;scrollY=document.documentElement.scrollTop}else if(document.body){scrollX=document.body.scrollLeft;scrollY=document.body.scrollTop}};function sns_convert_time(string_time,now){if(now==undefined)now=Date.now();ts_this=Date.parse(string_time.replace(/-/g,"/"));now_delta=now-ts_this;if(now_delta>36e5*24*3){dt_this=new Date(ts_this);return dt_this.getFullYear()+"-"+(dt_this.getMonth()+1)+"-"+dt_this.getDate()+" "+dt_this.getHours()+":"+dt_this.getMinutes()}else if(now_delta>36e5*24){return Math.floor(now_delta/36e5/24)+"天前"}else if(now_delta>36e5){return Math.floor(now_delta/36e5)+"小时前"}else if(now_delta>6e4){return Math.floor(now_delta/6e4)+"分钟前"}return"刚刚"}function _calcColumnsWidth(dataColumns,extra){widthTotal=extra;for(i=0;i<dataColumns.length;i++){widthTotal+=dataColumns[i]["width"]}return widthTotal}function datagrid_Autosize(datagrid_obj,extra){dataColumns=datagrid_obj.datagrid("options")["columns"][0];datagrid_obj.datagrid("resize",{width:_calcColumnsWidth(dataColumns,extra)})}function syntaxhighlighter_path(){var args=arguments,result=[];for(var i=0;i<args.length;i++)result.push(args[i].replace("@","/static/syntaxhighlighter_3.0.83/scripts/"));return result}function syntaxhighlighter_init(){$("pre").each(function(){if(this.className==""){this.className="brush:python"}});SyntaxHighlighter.autoloader.apply(null,syntaxhighlighter_path("bash shell             @shBrushBash.js","cpp c                  @shBrushCpp.js","css                    @shBrushCss.js","java                   @shBrushJava.js","js jscript javascript  @shBrushJScript.js","php                    @shBrushPhp.js","text plain             @shBrushPlain.js","py python              @shBrushPython.js","sql                    @shBrushSql.js","vb vbnet               @shBrushVb.js","xml xhtml xslt html    @shBrushXml.js"));SyntaxHighlighter.defaults["toolbar"]=false;SyntaxHighlighter.all()}function fmt_integer_low100(val){if(val==0)return"00";if(val<10)return"0"+val;return String(val)}function fmt_time(duration){ret_val="";if(duration>=3600){ret_val+=fmt_integer_low100(Math.floor(duration/3600))+":"}ret_val+=fmt_integer_low100(Math.floor(duration%3600/60))+":";ret_val+=fmt_integer_low100(Math.floor(duration%60));return ret_val}function normal_ajax(url,data_user,succ_callback,fail_callback){$.ajax({url:url,type:"GET",data:data_user,dataType:"json",success:function(data){if(typeof succ_callback=="function")succ_callback(data)},error:function(data){if(typeof fail_callback=="function")fail_callback(data)}})}$(function(){$(".inputip").blur(function(){if(!$(this).val()){$(this).val(this.defaultValue);$(this).css("color","#e3e3e3")}}).focus(function(){if($(this).val()==this.defaultValue){$(this).val("")}$(this).css("color","#000000")});$(".inputpwd").blur(function(){if(!$(this).val()){$(this).val(this.defaultValue);$(this).css("color","#e3e3e3");this.type="text"}}).focus(function(){if($(this).val()==this.defaultValue){$(this).val("")}this.type="password";$(this).css("color","#000000")})});function enum_object_property(obj){var props="";for(var p in obj){if(typeof obj[p]==" function "){}else{props+=p+" = "+obj[p]+";"}}return props}function pre_share_link(lineLink){if(typeof g_share_watermark=="undefined"||g_share_watermark=="")return lineLink;lineLink=lineLink.replace(/\bx=[^&]*&?/,"");if(lineLink[lineLink.length-1]=="&")lineLink=lineLink.substr(0,lineLink.length-1);if(lineLink[lineLink.length-1]=="?")lineLink=lineLink.substr(0,lineLink.length-1);return lineLink.indexOf("?")>0?lineLink+"&x="+g_share_watermark:lineLink+"?x="+g_share_watermark}function shareFriend(){WeixinJSBridge.invoke("sendAppMessage",{appid:appid,img_url:imgUrl,img_width:"200",img_height:"200",link:pre_share_link(lineLink),desc:descContent,title:shareTitle},function(res){})}function shareTimeline(){WeixinJSBridge.invoke("shareTimeline",{appid:appid,img_url:imgUrl,img_width:"200",img_height:"200",link:pre_share_link(lineLink),desc:descContent,title:shareTitle2},function(res){})}function shareWeibo(){WeixinJSBridge.invoke("shareWeibo",{content:descContent,url:pre_share_link(lineLink)},function(res){})}function on_share(){if(g_browser=="weixin"){$("#iosdownload").css({opacity:.9}).show()}else if(g_browser=="app"){var operation="sharetimeline";if(g_app_version>=2e4||g_app_name=="namiboxcp"){operation="share"}else{if(g_app_os=="ios"&&g_app_version<2e4){operation="sharefriend"}}js_app_send({command:"context",operation:operation})}else{alert("请到微信或APP里分享吧！");return false}return true}function app_js_hanler(message,responseCallback){if(window.AndroidWebViewJavascriptBridge){message=$.parseJSON(message)}cmd=message.command;if(cmd=="message")func_name="on_appmsg_"+message.message;else func_name="on_appcmd_"+cmd;if(typeof eval(func_name)=="function"){ret_val=eval(func_name).call(null,message);if(window.WebViewJavascriptBridge){if(responseCallback)responseCallback(ret_val)}else{if(ret_val!=null)ret_val["command"]=cmd;else ret_val={command:cmd};if(cmd!="message"&&cmd!="pushmsg")prompt($.toJSON(ret_val))}}}function js_app_send(message,responseCallback){if(window.WebViewJavascriptBridge){window.WebViewJavascriptBridge.send(message,responseCallback);return true}else if(window.AndroidWebViewJavascriptBridge){ret_val=prompt($.toJSON(message));if(responseCallback)responseCallback($.parseJSON(ret_val));return true}return false}function android_app_ready(){var readyEvent=document.createEvent("Events");readyEvent.initEvent("AndroidWebViewJavascriptBridge");window.AndroidWebViewJavascriptBridge=true;document.dispatchEvent(readyEvent)}function android_app_ready_auto(){}function ios_app_ready_auto(){if(window.WebViewJavascriptBridge2){return}var messagingIframe;var sendMessageQueue=[];var receiveMessageQueue=[];var messageHandlers={};var CUSTOM_PROTOCOL_SCHEME="wvjbscheme";var QUEUE_HAS_MESSAGE="__WVJB_QUEUE_MESSAGE__";var responseCallbacks={};var uniqueId=1;function _createQueueReadyIframe(doc){messagingIframe=doc.createElement("iframe");messagingIframe.style.display="none";doc.documentElement.appendChild(messagingIframe)}function init(messageHandler){if(window.WebViewJavascriptBridge._messageHandler){throw new Error("WebViewJavascriptBridge.init called twice")}window.WebViewJavascriptBridge._messageHandler=messageHandler;var receivedMessages=receiveMessageQueue;receiveMessageQueue=null;for(var i=0;i<receivedMessages.length;i++){_dispatchMessageFromObjC(receivedMessages[i])}}function send(data,responseCallback){_doSend({data:data},responseCallback)}function registerHandler(handlerName,handler){messageHandlers[handlerName]=handler}function callHandler(handlerName,data,responseCallback){_doSend({handlerName:handlerName,data:data},responseCallback)}function _doSend(message,responseCallback){if(responseCallback){var callbackId="cb_"+uniqueId++ +"_"+(new Date).getTime();responseCallbacks[callbackId]=responseCallback;message["callbackId"]=callbackId}sendMessageQueue.push(message);messagingIframe.src=CUSTOM_PROTOCOL_SCHEME+"://"+QUEUE_HAS_MESSAGE}function _fetchQueue(){var messageQueueString=JSON.stringify(sendMessageQueue);sendMessageQueue=[];return messageQueueString}function _dispatchMessageFromObjC(messageJSON){setTimeout(function _timeoutDispatchMessageFromObjC(){var message=JSON.parse(messageJSON);var messageHandler;if(message.responseId){var responseCallback=responseCallbacks[message.responseId];if(!responseCallback){return}responseCallback(message.responseData);delete responseCallbacks[message.responseId]}else{var responseCallback;if(message.callbackId){var callbackResponseId=message.callbackId;responseCallback=function(responseData){_doSend({responseId:callbackResponseId,responseData:responseData})}}var handler=window.WebViewJavascriptBridge._messageHandler;if(message.handlerName){handler=messageHandlers[message.handlerName]}try{handler(message.data,responseCallback)}catch(exception){if(typeof console!="undefined"){console.log("window.WebViewJavascriptBridge: WARNING: javascript handler threw.",message,exception)}}}})}function _handleMessageFromObjC(messageJSON){if(receiveMessageQueue){receiveMessageQueue.push(messageJSON)}else{_dispatchMessageFromObjC(messageJSON)}}window.WebViewJavascriptBridge={init:init,send:send,registerHandler:registerHandler,callHandler:callHandler,_fetchQueue:_fetchQueue,_handleMessageFromObjC:_handleMessageFromObjC};var doc=document;_createQueueReadyIframe(doc);var readyEvent=doc.createEvent("Events");readyEvent.initEvent("WebViewJavascriptBridgeReady");readyEvent.bridge=window.WebViewJavascriptBridge;doc.dispatchEvent(readyEvent)}var wxshare="关注纳米盒，共同陪伴孩子成长！";function notification_app_ready(){try{if(typeof eval("namibox_app_ready")=="function"){eval("namibox_app_ready").call(null)}}catch(e){}}$(function(){if(window.WebViewJavascriptBridge){notification_app_ready()}else{try{document.addEventListener("WebViewJavascriptBridgeReady",function(){window.WebViewJavascriptBridge.init(app_js_hanler);notification_app_ready()},false)}catch(e){}}if(window.AndroidWebViewJavascriptBridge){notification_app_ready()}else{try{document.addEventListener("AndroidWebViewJavascriptBridge",function(){notification_app_ready()},false)}catch(e){}}try{document.addEventListener("WeixinJSBridgeReady",function onBridgeReady(){try{WeixinJSBridge.on("menu:share:appmessage",function(argv){shareFriend()});WeixinJSBridge.on("menu:share:timeline",function(argv){shareTimeline()});WeixinJSBridge.on("menu:share:weibo",function(argv){shareWeibo()})}catch(e){}},false)}catch(e){}});var imgUrl="http://r.namibox.com/tina/static/v/title.jpg";var lineLink="http://namibox.com/v";var descContent="专注小学阶段学习与成长教育，独具特色的功能，孩子小伙伴，家长小秘书。关注纳米盒，陪伴孩子成长！";var shareTitle="纳米盒：最好的小学生教育平台";var shareTitle2="我见过最好的小学生教育平台，推荐给爸爸妈妈，和纳米盒一起陪伴孩子成长！";var appid="wx210d6d66ba34cc83";function on_wx_jsapi_init(wx,is_debug,appid,timestamp,nonce,signature){wx.config({debug:is_debug,appId:appid,timestamp:timestamp,nonceStr:nonce,signature:signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]});wx.ready(function(){});wx.error(function(res){});wx.onMenuShareAppMessage({title:shareTitle,desc:descContent,link:pre_share_link(lineLink),imgUrl:imgUrl,type:"link",dataUrl:"",success:function(res){},cancel:function(res){}});wx.onMenuShareTimeline({title:shareTitle2,link:pre_share_link(lineLink),imgUrl:imgUrl,success:function(res){},cancel:function(res){}})}function on_appcmd_wxshare(message){return{url_image:imgUrl,url_link:pre_share_link(lineLink),share_content:descContent,share_title:shareTitle,share_friend:shareTitle2}}function on_appmsg_redirect(message){window.location=message&&message.redirect_url?message.redirect_url:window.location.href}function app_smart_redirect(redirect_url,browser,app_auto_close,dest_view_name,dest_view_redirect_url){if(browser!="app"){window.location=redirect_url?redirect_url:window.location.href;return}if(dest_view_name){js_app_send({command:"message",dest_view_name:dest_view_name,message:"redirect",redirect_url:dest_view_redirect_url})}if(app_auto_close){js_app_send({command:"closeview",view_name:""})}else window.location=redirect_url?redirect_url:window.location.href}function app_location(site,url,browser,view_name,region){if(browser=="app"){js_app_send({command:"openview",region_name:region?region:"popup",view_name:view_name,url:site+url,slide_direction:"right"})}else{window.location=url}}function on_appmsg_wxpayRsp(message){alert(message);if(message.retcode&&message.retcode==0){alert("跳转支付成功页面")}else{alert("跳转支付失败页面")}}function on_appmsg_wxloginRsp(message){if(message.ErrCode&&message.ErrCode==0){alert("跳页面js处理")}else{alert("跳转授权失败页面")}}function cms_on_response_refresh_more(){pos_scroll=window.getScrollPos();size_win=window.getWinSize();$(".want_more").each(function(){obj_cur=$(this);if(pos_scroll[1]+size_win[1]>=obj_cur.offset().top&&pos_scroll[1]<obj_cur.offset().top&&!$(this).attr("doing")){parent_obj=obj_cur.parent();while(parent_obj.length>0&&!parent_obj.hasClass("nblist"))parent_obj=parent_obj.parent();if(!parent_obj.length)return;obj_cur.attr("doing","true");data_user={section:obj_cur.attr("id"),item:parent_obj.find(".nblock:last").attr("id"),action:"refresh"};$.ajax({url:window.location.href,type:"GET",data:data_user,dataType:"json",error:function(XMLHttpRequest,textStatus,errorThrown){obj_cur.remove()},success:function(data){if(data.retcode=="SUCC"){if(data.html){$(data.html).insertBefore(obj_cur);if(g_app_os!="")app_init_a_element()}else obj_cur.remove();if(data.count_items<10)obj_cur.remove();else obj_cur.removeAttr("doing")}else obj_cur.remove()}})}})}function app_action_a_element(){var url=$(this).attr("hrefs")?$(this).attr("hrefs"):$(this).attr("href");if(!url)return false;if(!url.startWith("http://")){url=g_site+url}if($(this).attr("targets")){if($(this).attr("appcmd")&&g_app_version>=parseInt($(this).attr("appver"))){var attrs=this.attributes;var parms={command:$(this).attr("appcmd")};for(var i=0;i<attrs.length;i++){if(attrs[i].name.startWith("_app_")){var parm=attrs[i].name.replace("_app_","");parms[parm]=attrs[i].value}}js_app_send(parms)}else{js_app_send({command:"openview",region_name:"popup",view_name:$(this).attr("targets"),url:url})}if($(this).attr("auto_close")=="true"&&g_app_version>=2e4){js_app_send({command:"closeview",view_name:""})}return false}return true}function app_init_a_element(){$("a[targets][_ai_!=init]").each(function(){$(this).attr("_ai_","init").click(app_action_a_element)})}function GetSlideDirection(startX,startY,endX,endY){var dy=startY-endY;var dx=endX-startX;var result="";if(Math.abs(dx)<10&&Math.abs(dy)<10){return""}var angle=Math.atan2(dy,dx)*180/Math.PI;if(angle>=-30&&angle<30&&Math.abs(dx)>20){result="right"}else if(angle>=50&&angle<130&&Math.abs(dy)>10){result="up"}else if(angle>=-140&&angle<-40&&Math.abs(dy)>10){result="down"}else if((angle>=150&&angle<=180||angle>=-180&&angle<-150)&&Math.abs(dx)>20){result="left"}return result}stack_callback=[];function monitor_screen_slide(callback,event){var startX=0;var startY=0;var startT=new Date;if(event==undefined)event="touchmove";stack_callback.push([event,callback]);if(stack_callback.length>1)return;document.addEventListener("touchstart",function(ev){startX=ev.touches[0].clientX;startY=ev.touches[0].clientY;startT=new Date},false);document.addEventListener("touchend",function(ev){var endX,endY;endX=ev.changedTouches[0].clientX;endY=ev.changedTouches[0].clientY;endT=new Date-startT;var direction=GetSlideDirection(startX,startY,endX,endY);if(direction){ret_callback=0;for(var idx=0;idx<stack_callback.length;idx++){cur_callback=stack_callback[idx];if(cur_callback[0]=="touchend"&&typeof cur_callback[1]=="function")ret_callback|=cur_callback[1]("touchend",direction,endT)}if(ret_callback){ev.stopPropagation();ev.preventDefault()}}if(0){js_app_send({command:"message",dest_view_name:"foot",message:"slidescreen",direction:direction,duration:endT})}},false);document.addEventListener("touchmove",function(ev){var endX,endY;endX=ev.changedTouches[0].clientX;endY=ev.changedTouches[0].clientY;endT=new Date-startT;var direction=GetSlideDirection(startX,startY,endX,endY);if(direction){ret_callback=0;for(var idx=0;idx<stack_callback.length;idx++){cur_callback=stack_callback[idx];if(cur_callback[0]=="touchmove"&&typeof cur_callback[1]=="function")ret_callback|=cur_callback[1]("touchmove",direction,endT)}if(ret_callback){ev.stopPropagation();ev.preventDefault()}}},false)}Array.prototype.cut=function(from,to){var rest=this.slice((to||from)+1||this.length);this.length=from<0?this.length+from:from;return this.push.apply(this,rest)};Array.prototype.index=function(key){for(var i=0;i<this.length;i++){if(this[i]==key)return i}return-1};Array.prototype.remove=function(key){index=this.index(key);if(index>=0)this.cut(index);return this};String.prototype.endWith=function(s){if(s==null||s==""||this.length==0||s.length>this.length)return false;if(this.substring(this.length-s.length)==s)return true;else return false;return true};String.prototype.startWith=function(s){if(s==null||s==""||this.length==0||s.length>this.length)return false;if(this.substr(0,s.length)==s)return true;else return false;return true};function fullscreen_modal_auto_fitscreen(){if($("#overlay").length>0&&$("#overlay").css("display")!="none"){size_win=window.getWinSize();width_overlay=Math.max(size_win[0],document.body.clientWidth);height_overlay=Math.max(size_win[1],document.body.clientHeight);$("#overlay").css("width",width_overlay+"px").css("height",height_overlay+"px").show();pos_scroll=window.getScrollPos();obj_modal_item=$("#overlay .modal_item:visible");obj_modal_item.css("left",(size_win[0]-obj_modal_item.width())/2+pos_scroll[0]+"px").css("top",(size_win[1]-obj_modal_item.height())/2+pos_scroll[1]+"px")}}function fullscreen_modal(div_id){size_win=window.getWinSize();width_overlay=Math.max(size_win[0],document.body.clientWidth);height_overlay=Math.max(size_win[1],document.body.clientHeight);if($("#overlay").length==0){$('<div id="overlay">').css("position","absolute").css("background-color","white").css("opacity","0.9").css("top","0px").css("left","0px").css("display","none").css("z-index","600").click(function(){if($(this).attr("clickhide")){fullscreen_modal_hide(div_id)}}).appendTo($("body"));$(window).resize(fullscreen_modal_auto_fitscreen)}$("#overlay").show();$("#overlay .modal_item").hide();$("#"+div_id).css("background-color","white").css("opacity","1.0").addClass("modal_item").appendTo($("#overlay")).show();fullscreen_modal_auto_fitscreen()}function fullscreen_modal_hide(div_id){$("#overlay").hide();$("#"+div_id).hide()}